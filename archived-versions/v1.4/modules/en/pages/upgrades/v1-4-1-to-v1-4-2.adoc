= Upgrade from v1.4.1 to v1.4.2
:revdate: 2025-11-10
:page-revdate: {revdate}

== General information

An *Upgrade* button appears on the *Dashboard* screen whenever a new {harvester-product-name} version that you can upgrade to becomes available. For more information, see xref:./upgrades.adoc#_start_an_upgrade[Start an upgrade].

For air-gapped environments, see xref:./upgrades.adoc#_prepare_an_air_gapped_upgrade[Prepare an air-gapped upgrade].

=== Update Harvester UI Extension on {rancher-short-name} v2.10.1

To import {harvester-product-name} v1.4.2 clusters on {rancher-short-name} v2.10.1, you must use **v1.0.3** of the {rancher-short-name} UI extension for {harvester-product-name}.

. On the {rancher-short-name} UI, go to *local -> Apps -> Repositories*.

. Locate the repository named *harvester*, and then select *â‹® -> Refresh*.
+
This repository has the following properties:
+
* URL: **https://github.com/harvester/harvester-ui-extension**
* Branch: **gh-pages**
+
image::upgrade/rancher-2.10.1-repository-page.png[]

. Go to the *Extensions* screen.

. Locate the extension named *Harvester*, and then click *Update*.

. Select version *1.0.3*, and then click *Update*.
+
image::upgrade/update-harvester-ui-extension-modal.png[]

. Allow some time for the extension to be updated, and then refresh the screen.

[IMPORTANT]
====
The {rancher-short-name} UI displays an error message after the extension is updated. The error message disappears when you refresh the screen.

This issue, which exists in {rancher-short-name} v2.10.0 and v2.10.1, will be fixed in v2.10.2. 
====

Related issues: https://github.com/harvester/harvester/issues/7234[#7234], https://github.com/rancher/capi-ui-extension/issues/107[#107]

== Virtual machine backup compatibility

You may encounter certain limitations when creating and restoring xref:../storage/csidriver.adoc#_virtual_machine_backup_compatibility[backups that involve external storage].

== Known issues

=== High CPU usage

High CPU usage may occur because of the `backup-target` setting's `refreshIntervalInSeconds` field. If the field is left empty or is set to `0`, {harvester-product-name} constantly refreshes the backup target, resulting in high CPU usage.

To fix the issue, update the value of `refreshIntervalInSeconds` to a larger number (for example, `60`) using the command `kubectl edit setting backup-target`.

Example:

[,shell]
----
value: '{"type":"nfs","endpoint":"nfs://longhorn-test-nfs-svc.default:/opt/backupstore", "refreshIntervalInSeconds": 60}'
----

Related issue: https://github.com/harvester/harvester/issues/7885[#7885]

=== Upgrade restarts unexpectedly after the "Dismiss it" button is clicked

When you use {rancher-short-name} to upgrade {harvester-product-name}, the {rancher-short-name} UI displays a dialog with a button labeled "Dismiss it". Clicking this button may result in the following issues:

* The `status` section of the `harvesterhci.io/v1beta1/upgrade` CR is cleared, causing the loss of all important information about the upgrade.
* The upgrade process restarts unexpectedly.

This issue affects {rancher-short-name} v2.10.x, which uses v1.0.2, v1.0.3, and v1.0.4 of the xref:../integrations/rancher/harvester-ui-extension.adoc#_support_matrix[Harvester UI Extension]. All {harvester-product-name} UI versions are not affected. The issue is fixed in Harvester UI Extension v1.0.5 and v1.5.0.

To avoid this issue, perform either of the following actions:

* Use the {harvester-product-name} UI for upgrades. Clicking the "Dismiss it" button on the {harvester-product-name} UI does not result in unexpected behavior.
* Instead of clicking the button on the {rancher-short-name} UI, run the following command against the cluster:
+
[,shell]
----
kubectl -n harvester-system label upgrades -l harvesterhci.io/latestUpgrade=true harvesterhci.io/read-message=true
----

Related issue: https://github.com/harvester/harvester/issues/7791[#7791]

=== Virtual machines that use migratable RWX volumes restart unexpectedly

Virtual machines that use migratable xref:integrations/rancher/csi-driver.adoc#_rwx_volumes_support[RWX volumes] restart unexpectedly when the CSI plugin pods are restarted. This issue affects {harvester-product-name} v1.4.x, v1.5.0, and v1.5.1.

The workaround is to disable the setting https://documentation.suse.com/cloudnative/storage/1.8/en/longhorn-system/settings.html#_automatically_delete_workload_pod_when_the_volume_is_detached_unexpectedly[Automatically Delete Workload Pod When The Volume Is Detached Unexpectedly] on the {longhorn-product-name} UI before starting the upgrade. You must enable the setting again once the upgrade is completed.

The issue will be fixed in {longhorn-product-name} v1.8.3, v1.9.1, and later versions. {harvester-product-name} v1.6.0 will include {longhorn-product-name} v1.9.1. 

Related issues: https://github.com/harvester/harvester/issues/8534[#8534] and https://github.com/longhorn/longhorn/issues/11158[#11158]